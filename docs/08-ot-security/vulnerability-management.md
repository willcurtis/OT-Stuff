# OT Vulnerability Management  
**CVE Handling, Firmware Governance, Patch Strategy, Risk Scoring, Compensating Controls, Vendor Coordination**

OT vulnerability management differs significantly from IT:

- OT systems cannot be restarted freely  
- Firmware updates may cause instability  
- Vendors often do not publish security advisories  
- Lifecycle is 10–20+ years  
- Real-time protocols cannot be interrupted  
- Many devices cannot run modern crypto  

This chapter defines a realistic vulnerability management process for OT/BMS.

---

# 1. OT Vulnerability Management Objectives

1. **Identify vulnerabilities** in OT systems (controllers, gateways, servers).  
2. **Assess risk** using OT-specific criteria.  
3. **Define compensating controls** when patches are unavailable.  
4. **Plan safe remediation** within maintenance windows.  
5. **Track lifecycle and ensure long-term security posture**.

---

# 2. OT Asset Classes & Vulnerability Types

### 2.1 Controllers (AHU, FCU, VRF/VRV, Lighting, KNX, BACnet)
Typical vulnerabilities:
- Default credentials  
- Weak protocol implementations  
- No TLS support  
- Command injection (rare but possible)  
- Path traversal in embedded web UIs  

### 2.2 Gateways (Modbus, KNX, BACnet, OPC, DALI)
Typical vulnerabilities:
- Outdated firmware  
- Unauthenticated management UIs  
- Exposed services  
- Weak TLS stacks  

### 2.3 Supervisors / Servers
Typical vulnerabilities:
- Windows/Linux CVEs  
- Outdated libraries  
- SQL vulnerabilities  
- Web application flaws (XSS, CSRF, auth bypass)  

### 2.4 IoT Sensor Gateways
Typical vulnerabilities:
- Hardcoded passwords  
- Cloud backdoor agents  
- Poor firmware signing  

### 2.5 Network Infrastructure
Typical vulnerabilities:
- SNMP v1/v2c  
- Old SSH ciphers  
- Weak passwords  

---

# 3. Vulnerability Identification Process

### 3.1 Input Sources
- CVE databases  
- Vendor security advisories  
- ICS-CERT bulletins  
- SIEM alerts  
- Pen tests  
- Firmware scans (if supported)  
- Network scans (safe profiles only)  
- Cloud vendor disclosure portals  

### 3.2 Inventory Prerequisite
A **complete asset inventory** is required:

Device type
Model
Firmware version
Protocol usage (BACnet, Modbus, KNX, MQTT)
Network location (VLAN, building)
Criticality
Vendor contact

OT vulnerability management is impossible without this baseline.

---

# 4. OT Risk Scoring (Adjusted CVSS)

CVSS alone is not sufficient in OT.  
We apply an OT-adjusted risk model:

| Factor | Weight | Notes |
|--------|--------|-------|
| Exploitability | High | Protocol-level weaknesses matter more |
| Impact to Safety | Critical | HVAC, smoke control, lifts |
| Impact to Operations | High | Comfort, energy, business |
| Ease of Exploitation | High | Default creds? Open BACnet? |
| Patch Availability | Medium | Often unavailable |
| Device Importance | High | Controllers vs sensors |
| Blast Radius Potential | High | VLAN-wide, multi-building |

A scoring matrix is provided:

Critical → Remediate / isolate immediately
High     → Mitigate within 30–60 days
Medium   → Mitigate within 90–180 days
Low      → Track and plan in lifecycle

---

# 5. Compensating Controls (When Patches Are Impossible)

OT often cannot patch devices.  
Compensating controls are essential.

### Types of compensating controls:

1. **Firewalling**
   - Block vulnerable service ports  
   - Restrict source IPs  

2. **Protocol Whitelisting**
   - Allow reads only  
   - Block writes (Modbus, BACnet)  

3. **Segmentation**
   - Place vulnerable device in dedicated VLAN  

4. **Jump-Host Enforcement**
   - Restrict management access  
   - Disable direct web UI  

5. **Rate Limiting**
   - Slow protocol abuse  
   - Prevent flood attacks  

6. **TLS Offload / Proxying**
   - Wrap insecure protocols in secured tunnels  

7. **Monitoring**
   - SIEM alerts on unusual behaviour  
   - Detect rogue writes  

8. **Vendor Wrappers**
   - Use gateways to sanitise unsafe protocols  

---

# 6. Patch Management for OT

PATCHING MUST NEVER CAUSE BUILDING OUTAGES.

### 6.1 Patch Tiers

| Tier | Asset Type | Patch Frequency |
|------|------------|------------------|
| Tier 1 | Supervisors, servers | Monthly (approved) |
| Tier 2 | Gateways | Quarterly |
| Tier 3 | Controllers | Annually (or during shutdown) |
| Tier 4 | IoT devices | Case-by-case |

### 6.2 Patch Testing
All patches must be:
- Tested on identical hardware or vendor lab  
- Approved by vendor  
- Reviewed by OT and IT  

### 6.3 Patch Windows
- Nights, weekends, or scheduled shutdowns  
- Co-ordinated with FM/Building Ops  
- Engineering team must be present  

### 6.4 Rollback Plans
ALWAYS:
- Backup configuration  
- Snapshot VMs  
- Store firmware offline  
- Have a spare controller available  

---

# 7. Firmware Governance

### Required:
- Firmware inventory  
- End-of-support tracking  
- Vendor security bulletin subscription  
- File integrity checks (SHA256)  
- Approved firmware repository  

### Rules:
- Never upgrade firmware during peak building occupancy  
- Never mix firmware generations across a single subsystem unless validated  
- Always validate BACnet/Modbus point tables after upgrade  

### Firmware Deployment Workflow:

	1.	Identify required firmware
	2.	Validate vendor approval
	3.	Backup existing config
	4.	Perform upgrade in maintenance window
	5.	Validate system behaviour
	6.	Document version

---

# 8. Vulnerability Exception Process

OT systems sometimes cannot be remediated.  
A formal exception process ensures visibility and risk tracking.

### Process:
1. Identify vulnerability  
2. Assess risk (with OT-adjusted matrix)  
3. Document technical justification  
4. Apply compensating controls  
5. Assign expiry/review date  
6. Approve via OT, IT security, and Facilities  

### Exceptions must not be permanent.  
Review every 6–12 months.

---

# 9. Vendor Coordination

Vendors are essential in OT vulnerability remediation.

### Requirements:
- Vendors must supply security bulletins  
- Vendors must provide firmware lifecycle info  
- Vendors must provide security best practices  
- Vendors must support patch planning  
- Vendors must comply with jump-host policy  

### Restrictions:
- Vendors cannot apply patches without approval  
- Vendors cannot use remote tools unsupervised  
- Vendors cannot deploy cloud connectors without review  

---

# 10. Vulnerability Management Workflow (End-to-End)

```mermaid
flowchart TD
    ID(Identify Vulnerability) --> INV(Inventory & Classification)
    INV --> SCORE(Risk Scoring)
    SCORE --> DECISION{Patch Available?}
    DECISION -->|Yes| PATCH(Patch / Firmware Plan)
    DECISION -->|No| COMP(Compensating Controls)
    PATCH --> VALIDATE(Validation & Testing)
    COMP --> VALIDATE
    VALIDATE --> WINDOW(Maintenance Window)
    WINDOW --> DEPLOY(Deployment)
    DEPLOY --> VERIFY(Service Verification)
    VERIFY --> DOCUMENT(Document & Close)
    DOCUMENT --> REVIEW(Periodic Review)

# 11. Monitoring for Vulnerability Indicators

OT monitoring can detect vulnerable behaviour before a CVE is known.

Indicators:
	•	Broadcast rate anomalies
	•	Unexpected Modbus writes
	•	Excessive KNX tunnelling sessions
	•	MQTT authentication failures
	•	Supervisor CPU spikes
	•	Firmware downgrade attempts
	•	Rogue device on VLAN

These signals must feed SIEM rules.

# 12. Vulnerability Reporting Structure

Reports should include:
	•	Asset affected
	•	CVE reference (if available)
	•	Attack vector
	•	Risk rating
	•	Detection method
	•	Proposed mitigation
	•	Compensating control (if needed)
	•	Validation steps

Delivered to:
	•	OT operations
	•	IT security
	•	Facilities
	•	Governance / Compliance

# 13. Lifecycle & End-of-Support (EOS/EOL)

A device past vendor support is a structural vulnerability.

Required actions:
	•	Track EOL/EOS dates
	•	Replace controllers beyond 10–15 years
	•	Replace gateways that cannot run current firmware
	•	Upgrade supervisors before OS end-of-life

# 14. Implementation Checklist

Asset Management
	•	Full inventory with firmware versions
	•	Vendor details recorded
	•	Criticality assigned

Vulnerability Identification
	•	CVE feeds monitored
	•	ICS-CERT alerts subscribed
	•	Vendor bulletins reviewed

Risk Scoring
	•	OT-adjusted scoring applied
	•	Safety/operations impact defined

Mitigation
	•	Patch approved or compensating controls implemented
	•	Firewall rules updated
	•	Monitoring rules added

Validation
	•	Change tested
	•	Logs reviewed
	•	System behaviour verified

# Summary

OT vulnerability management is about balancing risk, availability, and safety.
Because many OT devices cannot be patched, compensating controls play a central role.

A mature OT vulnerability program includes:
	•	Full asset inventory
	•	Continuous CVE surveillance
	•	OT-specific risk scoring
	•	Firmware governance
	•	Safe patch processes
	•	Exception tracking
	•	Vendor co-ordination

This ensures long-term resilience of building automation systems, even when components cannot be fully secured through traditional IT patching.
